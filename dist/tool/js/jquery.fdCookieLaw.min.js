/*!
 *  FDC CookieLaw Tool - v1.3.0
 *  Cookie & Privacy management tool
 *  GitHub: https://github.com/FattiDiCookies/italianPrivacyPolicy/tree/master/dist/tool
 *  Docs: https://github.com/FattiDiCookies/italianPrivacyPolicy/wiki/FDC-Tool
 *  Bugs: https://github.com/FattiDiCookies/italianPrivacyPolicy/issues
 *
 *  (c) 2015 by FDC Crew
 *  Made by FDC Crew and released under MIT License
 */
!function(a,b,c,d){"use strict";function e(b,c){this.element=b,this.settings=a.extend({},g,c),this._defaults=g,this._name=f,this.jsonDocs=this.settings.docs,this.init()}var f="fdCookieLaw",g={config:"config.json",docs:"docs/docs.complete.json",page:"",banner:"",bannerPosition:"",bootstrap:!1,acceptOnScroll:"",callbackOnAccepted:null,callbackOnNotAccepted:null,callbackOnRejected:null,callbackOnChoiseChange:null,debug:!1};a.extend(e.prototype,{init:function(){this.settings.debug===!0&&console.log(f+": start");var a=this;this.plugInit(a,!1)},plugInit:function(a,b){this.getConfig(a,b)},getConfig:function(b,c){this.settings.debug===!0&&console.log(f+": getConfig() -> loading config"),a.ajax({url:b.settings.config,dataType:"json",success:function(a){a.cookieBanner.cookieValueRejected="undefined"!==a.cookieBanner.cookieValueRejected?a.cookieBanner.cookieValueRejected:"rejected";var d=!1,e=!1,f=!1,g={};if(b.settings.banner===!0||a.cookieBanner.active===!0){g={cname:a.cookieBanner.cookieName,cvalue:a.cookieBanner.cookieValue,cvalue_rejected:a.cookieBanner.cookieValueRejected,exdays:a.cookieBanner.cookieExpire};var h=b.cookieHunter(b,g);h===!1?(d=!0,f=!0,null!==b.settings.callbackOnNotAccepted&&c===!1&&b.settings.callbackOnNotAccepted()):null!==b.settings.callbackOnAccepted&&b.settings.callbackOnAccepted()}""!==b.settings.page&&(d=!0,e=!0),d===!0&&b.getDocsData(b,a,e,f,g)},error:function(){b.settings.debug===!0&&console.log(f+": getConfig() -> ajax error loading config file"),a(b.element).html("<h1>Error!</h1>")}})},getDocsData:function(b,c,d,e,g){this.settings.debug===!0&&console.log(f+": getDocsData() -> loading documents"),a.ajax({url:b.jsonDocs,dataType:"json",success:function(a){if(e!==!1&&b.setBanner(b,c,a,g),d!==!1)switch(b.settings.page){case"privacy":b.getPrivacyPolicy(b,c,a);break;case"cookie":b.getCookiePolicy(b,c,a)}},error:function(){this.settings.debug===!0&&console.log(f+": getDocsData() -> ajax error loading docs")}})},setBanner:function(a,b,c,d){this.settings.debug===!0&&console.log(f+": setBanner() -> start banner"),""===a.settings.acceptOnScroll?d.acceptOnScroll=b.cookieBanner.acceptOnScroll:d.acceptOnScroll=a.settings.acceptOnScroll,a.settings.banner===!0&&(d.position=a.settings.bannerPosition,a.getCookieBanner(b,a,c,d)),""===a.settings.banner&&a.settings.banner!==!1&&b.cookieBanner.active===!0&&(d.position=b.cookieBanner.position,a.getCookieBanner(b,a,c,d))},getPrivacyPolicy:function(b,c,e){this.settings.debug===!0&&console.log(f+": getPrivacyPolicy() --> load page");var g,h=e.privacy_policy_docs["privacy-policy"],i="",j="",k=c.privacyPolicy.personalData.length,l="",m=c.privacyPolicy.purposes.length,n="",o="",p="";if(c.privacyPolicy.deviceDataTitle!==d&&""!==c.privacyPolicy.deviceDataTitle?c.privacyPolicy.deviceDataTitle=c.privacyPolicy.deviceDataTitle:c.privacyPolicy.deviceDataTitle="Dati relativi al dispositivo dell'utente",c.privacyPolicy.deviceDataDesc!==d&&""!==c.privacyPolicy.deviceDataDesc?c.privacyPolicy.deviceDataDesc=c.privacyPolicy.deviceDataDesc:c.privacyPolicy.deviceDataDesc="Sono dati raccolti automaticamente dal sistema che riguardano il dispositivo con il quale viene navigato il sito. I dati così raccolti vengono conservati in forma completamente anonima e sono consultabili solo in forma aggreta. In alcuni casi l'indirizzo ip viene anonimizzato sottraendo ad esso le ultime tre cifre.",c.privacyPolicy.deviceData!==d&&""!==c.privacyPolicy.deviceData?(c.privacyPolicy.deviceData=c.privacyPolicy.deviceData,g=c.privacyPolicy.deviceData.length):(c.privacyPolicy.deviceData=["indirizzo internet protocol (IP)","tipo di browser","dispositivo usato per connettersi al sito","internet service provider (ISP)","data e orario di visita","pagina web di provenienza del visitatore (referral) e di uscita","numero di click"],g=c.privacyPolicy.deviceData.length),c.privacyPolicy.personalDataTitle!==d&&""!==c.privacyPolicy.personalDataTitle?c.privacyPolicy.personalDataTitle=c.privacyPolicy.personalDataTitle:c.privacyPolicy.personalDataTitle="Dati personali dell'utente",c.privacyPolicy.personalDataDesc!==d&&""!==c.privacyPolicy.personalDataDesc?c.privacyPolicy.personalDataDesc=c.privacyPolicy.personalDataDesc:c.privacyPolicy.personalDataDesc="I dati personali dell'utente vengono rilasciati volontariamente, dove espressamente richiesto, e sono conservati secondo le modalità descritte.",j+="<p><strong>"+c.privacyPolicy.deviceDataTitle+"</strong><br>",j+="<small><em>"+c.privacyPolicy.deviceDataDesc+"</em></small></p>",a.each(c.privacyPolicy.deviceData,function(a,b){p=a===g-1?".":";",n=0===a?"<ul>":"",o=a===g-1?"</ul>":"",j+=n+"<li>"+b+p+"</li>"+o}),i+="<p><strong>"+c.privacyPolicy.personalDataTitle+"</strong><br>",i+="<small><em>"+c.privacyPolicy.personalDataDesc+"</em></small></p>",a.each(c.privacyPolicy.personalData,function(a,b){p=a===k-1?".":";",n=0===a?"<ul>":"",o=a===k-1?"</ul>":"",i+=n+"<li>"+b+p+"</li>"+o}),a.each(c.privacyPolicy.purposes,function(a,b){p=a===m-1?".":";",n=0===a?"<ul>":"",o=a===m-1?"</ul>":"",l+=n+"<li>"+b+p+"</li>"+o}),h=h.replace(/\[\[NOME SITO\]\]/g,c.globals.site.name),h=h.replace(/\[\[URL SITO\]\]/g,c.globals.site.url),h=h.replace(/\[\[SOCIETA-RESPONSABILE\]\]/g,c.globals.company.name),h=h.replace(/\[\[INDIRIZZO\]\]/g,c.globals.company.address),""!==c.globals.company.vatNumber){var q=c.globals.company.vatLabel+" "+c.globals.company.vatNumber;h=h.replace(/\[\[PIVA\]\]/g,q)}h=h.replace(/\[\[NOME E COGNOME DEL RESPONSABILE\]\]/g,c.globals.administrator.name),h=h.replace(/\[\[EMAIL DI CONTATTO\]\]/g,c.globals.site.email),h=h.replace(/\[\[DATI DISPOSITIVO\]\]/g,j),h=h.replace(/\[\[DATI PERSONALI\]\]/g,i),h=h.replace(/\[\[SCOPI RACCOLTA DATI\]\]/g,l),a(b.element).html(h)},getCookiePolicy:function(b,c,d){this.settings.debug===!0&&console.log(f+": getCookiePolicy()");var e=d.cookie_policy_docs["informativa-estesa"];e=e.replace(/\[\[NOME SITO\]\]/g,c.globals.site.name),e=e.replace(/\[\[URL SITO\]\]/g,c.globals.site.url),e=e.replace(/\[\[NOME E COGNOME DEL RESPONSABILE\]\]/g,c.globals.administrator.name),e=e.replace(/\[\[ELENCO SERVIZI\]\]/g,'<div id="cookiePolicyServices" class="fdctool__services panel-group" role="tablist" aria-multiselectable="true"></div>'),e=e.replace(/\[\[PRIVACY-POLICY\]\]/g,'<a href="'+c.privacyPolicy.url+'" class="fdc-cookielaw__privacy-link">LINK</a>'),a(b.element).html(e);var g="",h={cname:c.cookieBanner.cookieName,cvalue:c.cookieBanner.cookieValue,cvalue_rejected:c.cookieBanner.cookieValueRejected,exdays:c.cookieBanner.cookieExpire},i=this.cookieHunter(b,h),j={accept:b.settings.bootstrap===!0?"btn btn-primary":"button",reject:b.settings.bootstrap===!0?"btn btn-danger":"button button-red"};g+='<div class="fdc-cookielaw__policy-buttons">    <button class="'+j.accept+' on-policypage fdc-cookielaw__accept-button">Acconsento all\'uso dei cookie</button>    <button class="'+j.reject+" on-policypage fdc-cookielaw__reject-button\">Rimuovo il consenso all'uso dei cookie</button></div>",a(b.element).append(g),i===!1?(a(".fdc-cookielaw__reject-button.on-policypage").hide(),a(".fdc-cookielaw__accept-button.on-policypage").fadeIn()):(a(".fdc-cookielaw__accept-button.on-policypage").hide(),a(".fdc-cookielaw__reject-button.on-policypage").fadeIn()),b.cookieAcceptClick(b,h),b.cookieRejectClick(b,h),b.getServices(b,c,d)},getServices:function(b,c,d){a.each(c.cookiePolicy.services,function(e){if(this.active===!0){var f=c.cookiePolicy.services[e].catLabel,g=c.cookiePolicy.services[e].catName,h="servicesTool-"+g,i=0===e?" collapse in":" collapse",j={panel:b.settings.bootstrap===!0?" panel panel-default":"",panelHeading:b.settings.bootstrap===!0?" panel-heading":"",panelTitle:b.settings.bootstrap===!0?" panel-title":"",panelCollapse:b.settings.bootstrap===!0?" panel-collapse"+i:"",panelBody:b.settings.bootstrap===!0?" panel-body":""};a("#cookiePolicyServices").append('<div id="'+h+'" class="fdctool__services_cat panel'+j.panel+'"></div>'),a("#"+h).append('<div class="fdctool__services_cat-heading'+j.panelHeading+'" role="tab" id="'+h+'Heading"> <h4 class="fdctool__services_cat-title'+j.panelTitle+'"><a role="button" data-toggle="collapse" data-parent="#'+h+'" href="#'+h+'Collapse" aria-expanded="true" aria-controls="'+h+'Collapse">'+f+"</a></h4></div>"),a("#"+h).append('<div id="'+h+'Collapse" class="fdctool__services_cat-items'+j.panelCollapse+'" role="tabpanel" aria-labelledby="'+h+'Heading"><div class="fdctool__services_cat-items-body'+j.panelBody+'"></div></div>'),a.each(c.cookiePolicy.services[e].services,function(e,f){if(f===!0){var g=d.cookie_policy_docs[e];g+=b.serviceChoise_buttonBar_markup(b,c,e),"undefined"!=typeof g&&(g=g.replace(/\[\[NOME SITO\]\]/g,c.globals.site.name),g=g.replace(/\[\[URL SITO\]\]/g,c.globals.site.url),a("#"+h).find(".fdctool__services_cat-items-body").append(g))}})}}),b.serviceChoise_buttonBar_click(b,c)},getBannerText:function(a,b,c,d){var e="";return b.cookieBanner.text.customText===!1||""===b.cookieBanner.text.customText?(a.settings.debug===!0&&console.log(f+": getBannerText() -> load text"),b.cookieBanner.text.techCookies===!0&&b.cookieBanner.text.profCookies===!1&&(e=c.cookie_policy_docs.banner_tech),b.cookieBanner.text.techCookies===!0&&b.cookieBanner.text.profCookies===!0&&(e=c.cookie_policy_docs["banner_tech-prof"]),b.cookieBanner.text.techCookies===!1&&b.cookieBanner.text.profCookies===!0&&(e=c.cookie_policy_docs.banner_prof)):(a.settings.debug===!0&&console.log(f+": getBannerText() -> load custom text"),e=b.cookieBanner.text.customText),e},getCookieBanner:function(c,d,e,g){this.settings.debug===!0&&console.log(f+": getCookieBanner() -> load banner");var h=d.cookieHunter(d,g);if(h===!1){g.text=d.getBannerText(d,c,e,g),g.textLink='<a href="'+c.cookiePolicy.url+'" title="Informativa Estesa">informativa estesa</a>',g.text=g.text.replace(/\[\[INFORMATIVA-ESTESA\]\]/g,g.textLink),g.text=g.text.replace(/\[\[NOME SITO\]\]/g,c.globals.site.name);var i=(d.settings.bootstrap===!0?"bootstrap":"no-bootstrap",'<div id="fdCookieLawBanner" class="fdc-cookielaw__banner '+g.position+'Banner">');d.settings.bootstrap===!0?(i+='   <div class="container-fluid">',i+='       <div class="row">',i+='           <div class="fdc-cookielaw__banner-text col-md-12">',i+=g.text,i+="           </div>",i+="       </div>",i+='       <div class="row">',i+='           <div class="fdc-cookielaw__banner-buttons col-md-12">',i+='               <a href="'+c.cookiePolicy.url+'" class="btn btn-primary privacy">Informativa Estesa</a>',i+='               <a href="#" id="cookieAccept" class="btn btn-primary accept fdc-cookielaw__accept-button" href="'+c.cookiePolicy.url+'" class="button privacy">OK</a>',i+="           </div>",i+="       </div>",i+="   </div>"):(i+='   <div class="fdc-cookielaw__banner-text">',i+=g.text,i+="   </div>",i+='   <div class="fdc-cookielaw__banner-buttons">',i+='       <a href="'+c.cookiePolicy.url+'" class="button privacy">Informativa Estesa</a>',i+='       <a href="#" id="cookieAccept" class="button accept fdc-cookielaw__accept-button" href="'+c.cookiePolicy.url+'" class="button privacy">OK</a>',i+="   </div>"),i+="</div>",a("body").append(i),a("body").promise().done(function(){setTimeout(function(){a("#fdCookieLawBanner").addClass("showBanner")},100)}),d.cookieAcceptClick(d,g),g.acceptOnScroll===!0&&a(b).one("scroll",function(){a("#fdCookieLawBanner").removeClass("showBanner"),setTimeout(function(){a("#fdCookieLawBanner").remove()},1e3),d.writeCookie(g.cname,g.cvalue,g.exdays)})}},cookieAcceptClick:function(b,c){a(".fdc-cookielaw__accept-button").on("click",function(a){a.preventDefault(),b.cookieAccept(b,c,!0)})},cookieAccept:function(b,c,d){a("#fdCookieLawBanner").removeClass("showBanner"),setTimeout(function(){a("#fdCookieLawBanner").remove()},1e3),a(".fdc-cookielaw__accept-button.on-policypage").hide(),a(".fdc-cookielaw__reject-button.on-policypage").fadeIn(),b.writeCookie(c.cname,c.cvalue,c.exdays),d===!0&&(b.servicesChoise_handleAll(b,c.cname,!0),b.serviceChoise_buttonBar_acceptAllUpdate(b)),null!==b.settings.callbackOnAccepted&&b.settings.callbackOnAccepted()},cookieRejectClick:function(b,c){a(".fdc-cookielaw__reject-button").on("click",function(a){a.preventDefault(),b.cookieReject(b,c)})},cookieReject:function(a,b){a.writeCookie(b.cname,b.cvalue_rejected,b.exdays),a.servicesChoise_handleAll(a,b.cname,!1),a.plugInit(a,!0),null!==a.settings.callbackOnRejected&&a.settings.callbackOnRejected()},searchService:function(b,c,d){this.settings.debug===!0&&console.log(f+": searchService() -> start");var e=this;a.ajax({url:this.settings.config,dataType:"json",success:function(a){e.settings.debug===!0&&console.log(f+": searchService() -> get config");var g=e.serviceChoise_serviceHunter(e,a,b);g===!0?c():d()},error:function(){e.settings.debug===!0&&console.log(f+": searchService() -> AJAXERROR! getting config")}})},serviceChoise_serviceHunter:function(b,c,d){var e,f=c.cookieBanner.cookieName+"_services",g=b.readCookie(f);return g=g.split(","),e=-1===a.inArray(d,g)?!1:!0},serviceChoise_handleServiceCookie:function(b,c,e,f,g){var h,i=c.cookieBanner.cookieName+"_services",j=b.readCookie(i),k={action:f,changed:e,allowed_services:""},l={cname:c.cookieBanner.cookieName,cvalue:c.cookieBanner.cookieValue,cvalue_rejected:c.cookieBanner.cookieValueRejected,exdays:c.cookieBanner.cookieExpire};switch(f){case"add":j!==d&&""!==j&&j!==l.cvalue_rejected?(j=j.split(","),-1===a.inArray(e,j)&&j.push(e),k.allowed_services=j,h=j.toString()):(k.allowed_services=[e],h=e,b.cookieAccept(b,l,!1));break;case"remove":if(j!==d&&""!==j){j=j.split(",");var m=j.indexOf(e);m>-1&&j.splice(m,1),k.allowed_services=j,h=j.toString(),""===h&&(k.allowed_services=[],h=l.cvalue_rejected,b.cookieReject(b,l))}}null!==b.settings.callbackOnChoiseChange&&g===!0&&b.settings.callbackOnChoiseChange(k),b.writeCookie(i,h,c.cookieBanner.cookieExpire)},servicesChoise_handleAll:function(b,c,d){var e=c+"_services";d===!0?a.ajax({url:b.settings.config,dataType:"json",success:function(c){b.settings.debug===!0&&console.log(f+": servicesChoise_acceptAll() -> config loaded!"),a.each(c.cookiePolicy.services,function(d){this.active===!0&&a.each(c.cookiePolicy.services[d].services,function(a,d){d===!0&&b.serviceChoise_handleServiceCookie(b,c,a,"add",!1)})})},error:function(){b.settings.debug===!0&&console.log(f+": servicesChoise_acceptAll() -> AJAX ERROR!")}}):b.writeCookie(e,"rejected",365)},serviceChoise_buttonBar_markup:function(a,b,c){var d,e,f,g,h,i,j="accettato",k="non accettato",l={};return a.serviceChoise_serviceHunter(a,b,c)===!0?(d=' disabled="disabled"',e="",f="accepted"):(d="",e=' disabled="disabled"',f="rejected"),a.settings.bootstrap===!0?(g="btn btn-primary",h="btn btn-danger",l.panel="panel panel-default ",l.heading="panel-heading ",l.title="panel-title ",l.body="panel-body "):(g="button",h="button button-red",l.panel="",l.heading="",l.title="",l.body=""),i=' <div class="'+l.panel+"fdctool__services_item-choise "+f+'" data-cookie="'+c+'">\n   <div class="'+l.heading+'fdctool__services_item-choise-heading">\n       <h6 class="'+l.title+'fdctool__services_item-choise-title">La tua scelta: <span class="choise-label accepted"><span class="glyphicon glyphicon-ok-circle"></span> '+j+'</span><span class="choise-label rejected"><span class="glyphicon glyphicon-ban-circle"></span> '+k+'</span></h6>\n   </div>\n   <div class="'+l.body+'fdctool__services_item-choise-panelbody">\n       <p>Decidi se attivare o meno questo cookie. Ricorda che disabilitando questo cookie potresti non poter usufruire di alcuni servizi offerti da questo sito.</p>\n       <div class="fdctool__services_item-choise-buttons">\n           <button class="'+g+' item-choise-btn accept"'+d+'>Abilita</button>\n           <button class="'+h+' item-choise-btn reject"'+e+'>Disabilita</button>\n       </div>\n       <div class="fdctool__services_item-choise-msg">\n           <span class="glyphicon glyphicon-floppy-saved"></span> La tua scelta è stata salvata!\n       </div>\n    </div>\n </div>'},serviceChoise_buttonBar_click:function(b,c){a(".fdctool__services_item-choise").find(".item-choise-btn").on("click",function(d){d.preventDefault();var e=a(this).closest(".fdctool__services_item-choise").data("cookie"),f=a(this).closest(".fdctool__services_item-choise").find(".fdctool__services_item-choise-msg");f.hide(),a(this).hasClass("accept")?(b.serviceChoise_handleServiceCookie(b,c,e,"add",!0),a(this).attr("disabled",!0),a(this).closest(".fdctool__services_item-choise").find(".reject").attr("disabled",!1),a(this).closest(".fdctool__services_item-choise").removeClass("rejected"),a(this).closest(".fdctool__services_item-choise").addClass("accepted")):(b.serviceChoise_handleServiceCookie(b,c,e,"remove",!0),a(this).attr("disabled",!0),a(this).closest(".fdctool__services_item-choise").find(".accept").attr("disabled",!1),a(this).closest(".fdctool__services_item-choise").removeClass("accepted"),a(this).closest(".fdctool__services_item-choise").addClass("rejected")),f.fadeIn(),setTimeout(function(){f.fadeOut()},2e3)})},serviceChoise_buttonBar_acceptAllUpdate:function(b){a(".fdctool__services_item-choise").removeClass("rejected"),a(".fdctool__services_item-choise").addClass("accepted"),a(".fdctool__services_item-choise").find(".item-choise-btn.accept").attr("disabled",!0),a(".fdctool__services_item-choise").find(".item-choise-btn.reject").attr("disabled",!1)},cookieHunter:function(a,b){var c=a.readCookie(b.cname),e=c!==d&&c!==b.cvalue?!1:!0;return e},writeCookie:function(a,b,d){this.settings.debug===!0&&console.log(f+": writeCookie("+a+" "+b+" "+d+")");var e=new Date;e.setTime(e.getTime()+24*d*60*60*1e3);var g="expires="+e.toUTCString();c.cookie=a+"="+b+"; "+g+"; path=/ "},readCookie:function(a){this.settings.debug===!0&&console.log(f+": readCookie("+a+")");for(var b=a+"=",d=c.cookie.split(";"),e=0;e<d.length;e++){for(var g=d[e];" "==g.charAt(0);)g=g.substring(1);if(0===g.indexOf(b))return g.substring(b.length,g.length)}return""}}),a.fn[f]=function(b){return this.each(function(){a.data(this,"plugin_"+f)||a.data(this,"plugin_"+f,new e(this,b))})}}(jQuery,window,document);